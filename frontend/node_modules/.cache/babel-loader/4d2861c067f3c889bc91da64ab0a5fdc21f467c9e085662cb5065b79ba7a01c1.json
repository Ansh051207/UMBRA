{"ast":null,"code":"import CryptoJS from 'crypto-js';\n\n// Generate a secure random password\nexport const generatePassword = (length = 16) => {\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\n  let password = '';\n\n  // Check if crypto is available\n  if (typeof window !== 'undefined' && window.crypto) {\n    const randomValues = new Uint32Array(length);\n    window.crypto.getRandomValues(randomValues);\n    for (let i = 0; i < length; i++) {\n      password += charset[randomValues[i] % charset.length];\n    }\n  } else {\n    // Fallback for environments without crypto\n    for (let i = 0; i < length; i++) {\n      const randomIndex = Math.floor(Math.random() * charset.length);\n      password += charset[randomIndex];\n    }\n  }\n  return password;\n};\n\n// Hash password with salt\nexport const hashPassword = (password, salt) => {\n  return CryptoJS.PBKDF2(password, salt, {\n    keySize: 256 / 32,\n    iterations: 100000\n  }).toString();\n};\n\n// Generate initialization vector\nexport const generateIV = () => {\n  return CryptoJS.lib.WordArray.random(16).toString();\n};\n\n// Encrypt note content\nexport const encryptNote = (content, key) => {\n  const iv = generateIV();\n  const encrypted = CryptoJS.AES.encrypt(content, key, {\n    iv\n  });\n  return {\n    ciphertext: encrypted.toString(),\n    iv: iv,\n    salt: CryptoJS.lib.WordArray.random(16).toString()\n  };\n};\n\n// Decrypt note content\nexport const decryptNote = (ciphertext, key, iv) => {\n  try {\n    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, {\n      iv: CryptoJS.enc.Hex.parse(iv)\n    });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n  } catch (error) {\n    console.error('Decryption error:', error);\n    throw new Error('Failed to decrypt note');\n  }\n};\n\n// Generate note encryption key\nexport const generateNoteKey = () => {\n  return CryptoJS.lib.WordArray.random(32).toString(CryptoJS.enc.Hex);\n};\n\n// Export/import encrypted data\nexport const exportEncryptedData = (data, password) => {\n  const salt = CryptoJS.lib.WordArray.random(16);\n  const key = CryptoJS.PBKDF2(password, salt, {\n    keySize: 256 / 32,\n    iterations: 100000\n  });\n  const iv = CryptoJS.lib.WordArray.random(16);\n  const encrypted = CryptoJS.AES.encrypt(JSON.stringify(data), key, {\n    iv\n  });\n  return {\n    encrypted: encrypted.toString(),\n    salt: salt.toString(),\n    iv: iv.toString()\n  };\n};\nexport const importEncryptedData = (encryptedData, password) => {\n  try {\n    const key = CryptoJS.PBKDF2(password, CryptoJS.enc.Hex.parse(encryptedData.salt), {\n      keySize: 256 / 32,\n      iterations: 100000\n    });\n    const decrypted = CryptoJS.AES.decrypt(encryptedData.encrypted, key, {\n      iv: CryptoJS.enc.Hex.parse(encryptedData.iv)\n    });\n    return JSON.parse(decrypted.toString(CryptoJS.enc.Utf8));\n  } catch (error) {\n    throw new Error('Invalid password or corrupted data');\n  }\n};","map":{"version":3,"names":["CryptoJS","generatePassword","length","charset","password","window","crypto","randomValues","Uint32Array","getRandomValues","i","randomIndex","Math","floor","random","hashPassword","salt","PBKDF2","keySize","iterations","toString","generateIV","lib","WordArray","encryptNote","content","key","iv","encrypted","AES","encrypt","ciphertext","decryptNote","decrypted","decrypt","enc","Hex","parse","Utf8","error","console","Error","generateNoteKey","exportEncryptedData","data","JSON","stringify","importEncryptedData","encryptedData"],"sources":["/Users/anshagrawal/Desktop/umb/frontend/src/utils/cryptoUtils.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\n// Generate a secure random password\nexport const generatePassword = (length = 16) => {\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\n  let password = '';\n  \n  // Check if crypto is available\n  if (typeof window !== 'undefined' && window.crypto) {\n    const randomValues = new Uint32Array(length);\n    window.crypto.getRandomValues(randomValues);\n    \n    for (let i = 0; i < length; i++) {\n      password += charset[randomValues[i] % charset.length];\n    }\n  } else {\n    // Fallback for environments without crypto\n    for (let i = 0; i < length; i++) {\n      const randomIndex = Math.floor(Math.random() * charset.length);\n      password += charset[randomIndex];\n    }\n  }\n  \n  return password;\n};\n\n\n// Hash password with salt\nexport const hashPassword = (password, salt) => {\n  return CryptoJS.PBKDF2(password, salt, {\n    keySize: 256 / 32,\n    iterations: 100000\n  }).toString();\n};\n\n// Generate initialization vector\nexport const generateIV = () => {\n  return CryptoJS.lib.WordArray.random(16).toString();\n};\n\n// Encrypt note content\nexport const encryptNote = (content, key) => {\n  const iv = generateIV();\n  const encrypted = CryptoJS.AES.encrypt(content, key, { iv });\n  \n  return {\n    ciphertext: encrypted.toString(),\n    iv: iv,\n    salt: CryptoJS.lib.WordArray.random(16).toString()\n  };\n};\n\n// Decrypt note content\nexport const decryptNote = (ciphertext, key, iv) => {\n  try {\n    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, { \n      iv: CryptoJS.enc.Hex.parse(iv) \n    });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n  } catch (error) {\n    console.error('Decryption error:', error);\n    throw new Error('Failed to decrypt note');\n  }\n};\n\n// Generate note encryption key\nexport const generateNoteKey = () => {\n  return CryptoJS.lib.WordArray.random(32).toString(CryptoJS.enc.Hex);\n};\n\n// Export/import encrypted data\nexport const exportEncryptedData = (data, password) => {\n  const salt = CryptoJS.lib.WordArray.random(16);\n  const key = CryptoJS.PBKDF2(password, salt, { keySize: 256/32, iterations: 100000 });\n  const iv = CryptoJS.lib.WordArray.random(16);\n  \n  const encrypted = CryptoJS.AES.encrypt(JSON.stringify(data), key, { iv });\n  \n  return {\n    encrypted: encrypted.toString(),\n    salt: salt.toString(),\n    iv: iv.toString()\n  };\n};\n\nexport const importEncryptedData = (encryptedData, password) => {\n  try {\n    const key = CryptoJS.PBKDF2(password, \n      CryptoJS.enc.Hex.parse(encryptedData.salt), \n      { keySize: 256/32, iterations: 100000 }\n    );\n    \n    const decrypted = CryptoJS.AES.decrypt(encryptedData.encrypted, key, {\n      iv: CryptoJS.enc.Hex.parse(encryptedData.iv)\n    });\n    \n    return JSON.parse(decrypted.toString(CryptoJS.enc.Utf8));\n  } catch (error) {\n    throw new Error('Invalid password or corrupted data');\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}