{"ast":null,"code":"var _jsxFileName = \"/Users/anshagrawal/Desktop/umb/frontend/src/contexts/CryptoContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useCallback } from 'react';\nimport CryptoJS from 'crypto-js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CryptoContext = /*#__PURE__*/createContext();\nexport const useCrypto = () => {\n  _s();\n  return useContext(CryptoContext);\n};\n_s(useCrypto, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const CryptoProvider = ({\n  children\n}) => {\n  _s2();\n  const [masterKey, setMasterKey] = useState(null);\n\n  // Generate a random key\n  const generateKey = useCallback(() => {\n    return CryptoJS.lib.WordArray.random(32).toString();\n  }, []);\n\n  // Derive encryption key from password\n  const deriveKeyFromPassword = useCallback((password, salt) => {\n    return CryptoJS.PBKDF2(password, salt, {\n      keySize: 256 / 32,\n      iterations: 100000\n    }).toString();\n  }, []);\n\n  // Encrypt data with AES\n  const encrypt = useCallback((data, key) => {\n    const iv = CryptoJS.lib.WordArray.random(16);\n    const encrypted = CryptoJS.AES.encrypt(data, key, {\n      iv\n    });\n    return {\n      ciphertext: encrypted.toString(),\n      iv: iv.toString(),\n      algorithm: 'AES-CBC'\n    };\n  }, []);\n\n  // Decrypt data with AES\n  const decrypt = useCallback((ciphertext, key, iv) => {\n    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, {\n      iv: CryptoJS.enc.Hex.parse(iv)\n    });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n  }, []);\n\n  // Generate RSA key pair\n  const generateRSAKeyPair = useCallback(async () => {\n    // Note: In production, use Web Crypto API for RSA\n    // This is a simplified version using cryptojs\n    const keyPair = {\n      publicKey: `pub_${CryptoJS.lib.WordArray.random(32).toString()}`,\n      privateKey: `priv_${CryptoJS.lib.WordArray.random(64).toString()}`\n    };\n    return keyPair;\n  }, []);\n\n  // Encrypt symmetric key with RSA public key\n  const encryptWithPublicKey = useCallback((data, publicKey) => {\n    // Simplified - in production use proper RSA encryption\n    return `enc_${data}_${publicKey}`;\n  }, []);\n\n  // Decrypt symmetric key with RSA private key\n  const decryptWithPrivateKey = useCallback((encryptedData, privateKey) => {\n    // Simplified - in production use proper RSA decryption\n    return encryptedData.replace(/^enc_/, '').replace(new RegExp(`_${privateKey}$`), '');\n  }, []);\n  const value = {\n    masterKey,\n    setMasterKey,\n    generateKey,\n    deriveKeyFromPassword,\n    encrypt,\n    decrypt,\n    generateRSAKeyPair,\n    encryptWithPublicKey,\n    decryptWithPrivateKey\n  };\n  return /*#__PURE__*/_jsxDEV(CryptoContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s2(CryptoProvider, \"a8M9Tzf6QzszW/xZS0gRDVAQGjw=\");\n_c = CryptoProvider;\nvar _c;\n$RefreshReg$(_c, \"CryptoProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useCallback","CryptoJS","jsxDEV","_jsxDEV","CryptoContext","useCrypto","_s","CryptoProvider","children","_s2","masterKey","setMasterKey","generateKey","lib","WordArray","random","toString","deriveKeyFromPassword","password","salt","PBKDF2","keySize","iterations","encrypt","data","key","iv","encrypted","AES","ciphertext","algorithm","decrypt","decrypted","enc","Hex","parse","Utf8","generateRSAKeyPair","keyPair","publicKey","privateKey","encryptWithPublicKey","decryptWithPrivateKey","encryptedData","replace","RegExp","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/anshagrawal/Desktop/umb/frontend/src/contexts/CryptoContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useCallback } from 'react';\nimport CryptoJS from 'crypto-js';\n\nconst CryptoContext = createContext();\n\nexport const useCrypto = () => useContext(CryptoContext);\n\nexport const CryptoProvider = ({ children }) => {\n  const [masterKey, setMasterKey] = useState(null);\n\n  // Generate a random key\n  const generateKey = useCallback(() => {\n    return CryptoJS.lib.WordArray.random(32).toString();\n  }, []);\n\n  // Derive encryption key from password\n  const deriveKeyFromPassword = useCallback((password, salt) => {\n    return CryptoJS.PBKDF2(password, salt, {\n      keySize: 256 / 32,\n      iterations: 100000\n    }).toString();\n  }, []);\n\n  // Encrypt data with AES\n  const encrypt = useCallback((data, key) => {\n    const iv = CryptoJS.lib.WordArray.random(16);\n    const encrypted = CryptoJS.AES.encrypt(data, key, { iv });\n    \n    return {\n      ciphertext: encrypted.toString(),\n      iv: iv.toString(),\n      algorithm: 'AES-CBC'\n    };\n  }, []);\n\n  // Decrypt data with AES\n  const decrypt = useCallback((ciphertext, key, iv) => {\n    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, { iv: CryptoJS.enc.Hex.parse(iv) });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n  }, []);\n\n  // Generate RSA key pair\n  const generateRSAKeyPair = useCallback(async () => {\n    // Note: In production, use Web Crypto API for RSA\n    // This is a simplified version using cryptojs\n    const keyPair = {\n      publicKey: `pub_${CryptoJS.lib.WordArray.random(32).toString()}`,\n      privateKey: `priv_${CryptoJS.lib.WordArray.random(64).toString()}`\n    };\n    return keyPair;\n  }, []);\n\n  // Encrypt symmetric key with RSA public key\n  const encryptWithPublicKey = useCallback((data, publicKey) => {\n    // Simplified - in production use proper RSA encryption\n    return `enc_${data}_${publicKey}`;\n  }, []);\n\n  // Decrypt symmetric key with RSA private key\n  const decryptWithPrivateKey = useCallback((encryptedData, privateKey) => {\n    // Simplified - in production use proper RSA decryption\n    return encryptedData.replace(/^enc_/, '').replace(new RegExp(`_${privateKey}$`), '');\n  }, []);\n\n  const value = {\n    masterKey,\n    setMasterKey,\n    generateKey,\n    deriveKeyFromPassword,\n    encrypt,\n    decrypt,\n    generateRSAKeyPair,\n    encryptWithPublicKey,\n    decryptWithPrivateKey\n  };\n\n  return (\n    <CryptoContext.Provider value={value}>\n      {children}\n    </CryptoContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}