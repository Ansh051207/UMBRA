{"ast":null,"code":"import CryptoJS from 'crypto-js';\n\n// Generate a secure random password\nexport const generatePassword = (length = 32) => {\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\n  let password = '';\n  const randomValues = new Uint32Array(length);\n  crypto.getRandomValues(randomValues);\n  for (let i = 0; i < length; i++) {\n    password += charset[randomValues[i] % charset.length];\n  }\n  return password;\n};\n\n// Hash password with salt\nexport const hashPassword = (password, salt) => {\n  return CryptoJS.PBKDF2(password, salt, {\n    keySize: 256 / 32,\n    iterations: 100000\n  }).toString();\n};\n\n// Generate initialization vector\nexport const generateIV = () => {\n  return CryptoJS.lib.WordArray.random(16).toString();\n};\n\n// Encrypt note content\nexport const encryptNote = (content, key) => {\n  const iv = generateIV();\n  const encrypted = CryptoJS.AES.encrypt(content, key, {\n    iv\n  });\n  return {\n    ciphertext: encrypted.toString(),\n    iv: iv,\n    salt: CryptoJS.lib.WordArray.random(16).toString()\n  };\n};\n\n// Decrypt note content\nexport const decryptNote = (ciphertext, key, iv) => {\n  try {\n    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, {\n      iv: CryptoJS.enc.Hex.parse(iv)\n    });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n  } catch (error) {\n    console.error('Decryption error:', error);\n    throw new Error('Failed to decrypt note');\n  }\n};\n\n// Generate note encryption key\nexport const generateNoteKey = () => {\n  return CryptoJS.lib.WordArray.random(32).toString(CryptoJS.enc.Hex);\n};\n\n// Export/import encrypted data\nexport const exportEncryptedData = (data, password) => {\n  const salt = CryptoJS.lib.WordArray.random(16);\n  const key = CryptoJS.PBKDF2(password, salt, {\n    keySize: 256 / 32,\n    iterations: 100000\n  });\n  const iv = CryptoJS.lib.WordArray.random(16);\n  const encrypted = CryptoJS.AES.encrypt(JSON.stringify(data), key, {\n    iv\n  });\n  return {\n    encrypted: encrypted.toString(),\n    salt: salt.toString(),\n    iv: iv.toString()\n  };\n};\nexport const importEncryptedData = (encryptedData, password) => {\n  try {\n    const key = CryptoJS.PBKDF2(password, CryptoJS.enc.Hex.parse(encryptedData.salt), {\n      keySize: 256 / 32,\n      iterations: 100000\n    });\n    const decrypted = CryptoJS.AES.decrypt(encryptedData.encrypted, key, {\n      iv: CryptoJS.enc.Hex.parse(encryptedData.iv)\n    });\n    return JSON.parse(decrypted.toString(CryptoJS.enc.Utf8));\n  } catch (error) {\n    throw new Error('Invalid password or corrupted data');\n  }\n};","map":{"version":3,"names":["CryptoJS","generatePassword","length","charset","password","randomValues","Uint32Array","crypto","getRandomValues","i","hashPassword","salt","PBKDF2","keySize","iterations","toString","generateIV","lib","WordArray","random","encryptNote","content","key","iv","encrypted","AES","encrypt","ciphertext","decryptNote","decrypted","decrypt","enc","Hex","parse","Utf8","error","console","Error","generateNoteKey","exportEncryptedData","data","JSON","stringify","importEncryptedData","encryptedData"],"sources":["/Users/anshagrawal/Desktop/umb/frontend/src/utils/cryptoUtils.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\n// Generate a secure random password\nexport const generatePassword = (length = 32) => {\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\n  let password = '';\n  const randomValues = new Uint32Array(length);\n  \n  crypto.getRandomValues(randomValues);\n  \n  for (let i = 0; i < length; i++) {\n    password += charset[randomValues[i] % charset.length];\n  }\n  \n  return password;\n};\n\n// Hash password with salt\nexport const hashPassword = (password, salt) => {\n  return CryptoJS.PBKDF2(password, salt, {\n    keySize: 256 / 32,\n    iterations: 100000\n  }).toString();\n};\n\n// Generate initialization vector\nexport const generateIV = () => {\n  return CryptoJS.lib.WordArray.random(16).toString();\n};\n\n// Encrypt note content\nexport const encryptNote = (content, key) => {\n  const iv = generateIV();\n  const encrypted = CryptoJS.AES.encrypt(content, key, { iv });\n  \n  return {\n    ciphertext: encrypted.toString(),\n    iv: iv,\n    salt: CryptoJS.lib.WordArray.random(16).toString()\n  };\n};\n\n// Decrypt note content\nexport const decryptNote = (ciphertext, key, iv) => {\n  try {\n    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, { \n      iv: CryptoJS.enc.Hex.parse(iv) \n    });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n  } catch (error) {\n    console.error('Decryption error:', error);\n    throw new Error('Failed to decrypt note');\n  }\n};\n\n// Generate note encryption key\nexport const generateNoteKey = () => {\n  return CryptoJS.lib.WordArray.random(32).toString(CryptoJS.enc.Hex);\n};\n\n// Export/import encrypted data\nexport const exportEncryptedData = (data, password) => {\n  const salt = CryptoJS.lib.WordArray.random(16);\n  const key = CryptoJS.PBKDF2(password, salt, { keySize: 256/32, iterations: 100000 });\n  const iv = CryptoJS.lib.WordArray.random(16);\n  \n  const encrypted = CryptoJS.AES.encrypt(JSON.stringify(data), key, { iv });\n  \n  return {\n    encrypted: encrypted.toString(),\n    salt: salt.toString(),\n    iv: iv.toString()\n  };\n};\n\nexport const importEncryptedData = (encryptedData, password) => {\n  try {\n    const key = CryptoJS.PBKDF2(password, \n      CryptoJS.enc.Hex.parse(encryptedData.salt), \n      { keySize: 256/32, iterations: 100000 }\n    );\n    \n    const decrypted = CryptoJS.AES.decrypt(encryptedData.encrypted, key, {\n      iv: CryptoJS.enc.Hex.parse(encryptedData.iv)\n    });\n    \n    return JSON.parse(decrypted.toString(CryptoJS.enc.Utf8));\n  } catch (error) {\n    throw new Error('Invalid password or corrupted data');\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}